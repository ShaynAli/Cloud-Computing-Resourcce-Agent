<!DOCTYPE html>

<html lang="en">

    <head>

        <title>VM Portal</title>

        <meta charset="utf-8" lang="en">
        <meta name="description" content="admin portal">
        <meta name="author" content="Shayaan, Connor, Brandon, Willian">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <style>
            .right {
                width: 50%;
                float: right;
            }

            .left {
                width: 50%;
                float: left;
            }

            #vm-table {
                width: 100%;
                table-layout: fixed;
            }
        </style>
    </head>

    <body>

        <div id="vm-list" class="left">

            <form onsubmit="new_vm()">
                <input type="submit" value="new-vm">
            </form>
            <div id="total-vm-usage">$90.01</div>

            <form id="vm-option-form">
            <table id="vm-table">
                <tr>
                    <td>id</td>
                    <td>status</td>
                    <td>configuration</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>status</td>
                    <td>config</td>
                    <td><input id="select-vm1" type="submit"></input></td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>status</td>
                    <td>config</td>
                    <td><button>select</button></td>
                </tr>
            </table>
        </form>
        </div>

        <div id="vm-config" class="right">
            
            <form id="vm-config-form" onsubmit="">  <!-- TODO: Fix -->
                <input id="start-vm" type="submit" value="start" name="start">
                <input id="stop-vm" type="submit" value="stop" name="stop">
                <input id="delete-vm" type="submit" value="delete" name="delete">
                <br>
                <input id="upgrade-vm" type="submit" value="upgrade" name="upgrade">
                <input id="downgrade-vm" type="submit" value="downgrade" name="downgrade">
                <br>
                <div id="current-vm-usage">$13.37</div> 
            </form>
        
        </div>

    </body>

    <script>
        var current_vm;

        function init() {

            var form = document.getElementById("vm-config-form");

            document.getElementById("start-vm").addEventListener("click", function() {
                start_vm(current_vm);
            });

            document.getElementById("stop-vm").addEventListener("click", function() {
                stop_vm(current_vm);
            });

            document.getElementById("delete-vm").addEventListener("click", function() {
                delete_vm(current_vm);
            });

            document.getElementById("stop-vm").addEventListener("click", function() {
                stop_vm(current_vm);
            });

            document.getElementById("upgrade-vm").addEventListener("click", function() {
                upgrade_vm(current_vm);
            });

            document.getElementById("downgrade-vm").addEventListener("click", function() {
                downgrade_vm(current_vm);
            });

            document.getElementById("select-vm1").addEventListener("click", function() {
                select_vm(current_vm);
            });
        }

        function new_vm() {
            post("/createVM");
        }

        function select_vm(id) {
            document.getElementById("vm-config").style.visibility = "visible";
        }

        function start_vm(id) {
            post("/startVM/" + id);
            console.log("Start");
        }

        function stop_vm(id) {
            post("/stopVM/" + id);
        }

        function delete_vm(id) {
            post("/deleteVM/" + id);
        }

        function upgrade_vm(id) {
            post("/upgradeVM/" + id);
        }

        function downgrade_vm(id) {
            post("/downgradeVM/" + id);
        }

        function update_vm_price(id) {
            // TODO: Get Usage from server
        }

        function update_vm_total_price(id) {  }

        function post(path, params, method) {
            method = method || "post"; // Set method to post by default if not specified.

            // The rest of this code assumes you are not using a library.
            // It can be made less wordy if you use one.
            var form = document.createElement("form");
            form.setAttribute("method", method);
            form.setAttribute("action", path);

            for(var key in params) {
                if(params.hasOwnProperty(key)) {
                    var hiddenField = document.createElement("input");
                    hiddenField.setAttribute("type", "hidden");
                    hiddenField.setAttribute("name", key);
                    hiddenField.setAttribute("value", params[key]);

                    form.appendChild(hiddenField);
                }
            }

            document.body.appendChild(form);
            form.submit();
        }
    
    </script>

</html>
